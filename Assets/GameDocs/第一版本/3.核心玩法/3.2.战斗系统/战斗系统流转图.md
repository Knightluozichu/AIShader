### 《水浒-fuk-u》战斗系统流转图

---

#### 一、战斗流程总览

```mermaid
graph TD
    subgraph 战斗准备
        A1[进入战斗] -->|初始化| A2[抽取手牌]
        A2 -->|回合开始| A3[获得能量]
        A3 -->|准备完成| A4[行动阶段]
    end

    subgraph 战斗执行
        A4 -->|出牌| B1[技能释放]
        B1 -->|检测| B2[连击判定]
        B2 -->|结算| B3[效果生效]
        B3 -->|更新| B4[状态变化]
    end

    B4 -->|回合结束| A2
```

#### 二、卡牌出牌系统

```mermaid
graph LR
    subgraph 出牌流程
        C1[选择卡牌] -->|消耗能量| C2[卡牌激活]
        C2 -->|目标选择| C3[效果触发]
        C3 -->|动画播放| C4[结算伤害]
    end

    subgraph 卡牌效果
        C4 -->|造成| E1[直接效果]
        C4 -->|触发| E2[连锁效果]
        C4 -->|叠加| E3[状态效果]
    end
```

#### 三、连击系统流转

```mermaid
graph TD
    subgraph 连击触发
        D1[基础攻击] -->|符合条件| D2[连击开启]
        D2 -->|继续出牌| D3[连击累积]
        D3 -->|达到阈值| D4[连击爆发]
    end

    subgraph 连击效果
        D4 -->|产生| F1[伤害提升]
        D4 -->|获得| F2[特殊效果]
        D4 -->|积累| F3[连击点数]
    end

    subgraph 连击奖励
        F3 -->|转化| R1[额外能量]
        F3 -->|获得| R2[特殊卡牌]
        F3 -->|触发| R3[连击技能]
    end
```

#### 四、技能效果系统

```mermaid
graph LR
    subgraph 技能类型
        G1[攻击技能] -->|伤害| Effect[效果池]
        G2[防御技能] -->|减伤| Effect
        G3[增益技能] -->|强化| Effect
        G4[控制技能] -->|限制| Effect
    end

    subgraph 效果叠加
        Effect -->|计算| H1[数值叠加]
        Effect -->|组合| H2[效果联动]
        Effect -->|触发| H3[特殊效果]
    end
```

#### 五、战斗状态流转

```mermaid
graph TD
    subgraph 状态变化
        S1[基础状态] -->|施加| S2[状态叠加]
        S2 -->|持续| S3[状态更新]
        S3 -->|消失| S4[状态解除]
    end

    subgraph 状态效果
        S2 -->|影响| E1[属性变化]
        S2 -->|限制| E2[行动能力]
        S2 -->|触发| E3[特殊效果]
    end
```

#### 六、能量系统流转

```mermaid
graph TD
    subgraph 能量获取
        M1[回合开始] -->|基础| M2[能量池]
        M3[连击奖励] -->|额外| M2
        M4[特殊效果] -->|临时| M2
    end

    subgraph 能量消耗
        M2 -->|使用| N1[卡牌消耗]
        M2 -->|触发| N2[特殊技能]
        M2 -->|保留| N3[能量溢出]
    end
```

#### 七、伤害计算流程

```mermaid
graph LR
    subgraph 伤害形成
        P1[基础伤害] -->|计算| P2[最终伤害]
        P3[暴击判定] -->|影响| P2
        P4[连击加成] -->|提升| P2
    end

    subgraph 伤害处理
        P2 -->|抵消| Q1[护甲减伤]
        Q1 -->|计算| Q2[实际伤害]
        Q2 -->|造成| Q3[生命变化]
    end
```

---

#### 八、系统要点说明

1. **战斗节奏**
   - 回合制基础节奏
   - 连击加速机制
   - 能量管理策略

2. **战斗深度**
   - 卡牌组合
   - 连击技巧
   - 状态管理

3. **平衡设计**
   - 能量消耗
   - 连击收益
   - 状态持续

4. **反馈体验**
   - 打击感
   - 连击提示
   - 效果展示
